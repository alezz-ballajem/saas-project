"use strict";exports.id=633,exports.ids=[633],exports.modules={96121:(e,t,s)=>{s.d(t,{D:()=>j});var r=s(45512),a=s(58009),i=s(71004),n=s(5868),c=s(6868),l=s(24109),o=s(64833),d=s(55595),p=s(10963),u=s(92345),m=s(26248);let h=(0,m.createServerReference)("40fcdc1a3f812a5b9eb8f46640d49a2f893f411151",m.callServer,void 0,m.findSourceMapURL,"createProject");var x=s(22403);function j({isOpen:e,onClose:t,onSuccess:s}){let[m,j]=(0,a.useState)(!1),{register:f,handleSubmit:b,formState:{errors:g},reset:v}=(0,c.mN)(),y=async e=>{j(!0);try{let r=await h({name:e.name,description:e.description,groupId:process.env.NEXT_PUBLIC_GITLAB_GROUP_ID||"nextjs"});r.success?(x.Ay.success("Project created successfully!"),v(),t(),s?.()):x.Ay.error(r.error||"Failed to create project")}catch(e){x.Ay.error("An unexpected error occurred"),console.error("Error creating project:",e)}finally{j(!1)}},w=()=>{m||(v(),t())};return(0,r.jsx)(i.N,{children:e&&(0,r.jsxs)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:w}),(0,r.jsx)(n.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative w-full max-w-md",children:(0,r.jsxs)(d.Zp,{variant:"glass",className:"border-white/20",children:[(0,r.jsx)(d.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 rounded-xl bg-gradient-to-r from-primary-500 to-secondary-500",children:(0,r.jsx)(p.A,{className:"h-6 w-6 text-white"})}),(0,r.jsx)(d.ZB,{className:"text-white",children:"Create New Project"})]}),(0,r.jsx)(l.$,{variant:"ghost",size:"sm",onClick:w,disabled:m,children:(0,r.jsx)(u.A,{className:"h-5 w-5"})})]})}),(0,r.jsx)(d.Wu,{children:(0,r.jsxs)("form",{onSubmit:b(y),className:"space-y-6",children:[(0,r.jsx)(o.p,{label:"Project Name",placeholder:"Enter project name (e.g., nextjs-demo14)",...f("name",{required:"Project name is required",pattern:{value:/^[a-z0-9-]+$/,message:"Project name must contain only lowercase letters, numbers, and hyphens"},minLength:{value:3,message:"Project name must be at least 3 characters"}}),error:g.name?.message,helper:"This will be used as the GitLab repository name"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Description (Optional)"}),(0,r.jsx)("textarea",{className:"input-field w-full h-24 resize-none",placeholder:"Describe your project...",...f("description")})]}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-xl p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-white mb-2",children:"What happens next?"}),(0,r.jsxs)("ul",{className:"text-xs text-white/60 space-y-1",children:[(0,r.jsx)("li",{children:"• GitLab repository will be created"}),(0,r.jsx)("li",{children:"• Next.js project will be scaffolded"}),(0,r.jsx)("li",{children:"• CI/CD pipeline will be configured"}),(0,r.jsx)("li",{children:"• Project will be deployed to test environment"})]})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)(l.$,{type:"button",variant:"secondary",onClick:w,disabled:m,className:"flex-1",children:"Cancel"}),(0,r.jsx)(l.$,{type:"submit",loading:m,className:"flex-1",children:"Create Project"})]})]})})]})})]})})}},52064:(e,t,s)=>{s.d(t,{U:()=>v});var r=s(45512),a=s(58009),i=s(26008),n=s(5868),c=s(55595),l=s(24109),o=s(90788),d=s(6001),p=s(35592),u=s(28994),m=s(40994),h=s(67317),x=s(55216),j=s(28390),f=s(50615);let b={ACTIVE:{color:"text-green-400",icon:o.A,bg:"bg-green-500/10"},INACTIVE:{color:"text-yellow-400",icon:d.A,bg:"bg-yellow-500/10"},DELETED:{color:"text-red-400",icon:p.A,bg:"bg-red-500/10"}},g={SUCCESS:{color:"text-green-400",icon:o.A},FAILED:{color:"text-red-400",icon:p.A},RUNNING:{color:"text-blue-400",icon:u.A},PENDING:{color:"text-yellow-400",icon:u.A},CANCELED:{color:"text-gray-400",icon:p.A},SKIPPED:{color:"text-gray-400",icon:u.A}};function v({project:e,onDelete:t,onTriggerPipeline:s}){let[o,d]=(0,a.useState)(!1),p=b[e.status]||b.ACTIVE,u=e.pipelines[0],v=u?g[u.status]:null,y=async()=>{if(s){d(!0);try{await s(e.id)}finally{d(!1)}}};return(0,r.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,r.jsxs)(c.Zp,{variant:"glass",hover:!0,className:"h-full",children:[(0,r.jsx)(c.aR,{children:(0,r.jsx)("div",{className:"flex items-start justify-between",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(c.ZB,{className:"text-white text-xl mb-2",children:e.name}),e.description&&(0,r.jsx)("p",{className:"text-white/60 text-sm mb-3",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,r.jsxs)("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full ${p.bg}`,children:[(0,r.jsx)(p.icon,{className:`h-4 w-4 ${p.color}`}),(0,r.jsx)("span",{className:`text-sm font-medium ${p.color}`,children:e.status})]}),e.domain&&(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-white/60",children:[(0,r.jsx)("span",{className:"inline-block h-2 w-2 rounded-full bg-primary-400"}),(0,r.jsx)("span",{className:"text-sm",children:e.domain})]})]})]})})}),(0,r.jsxs)(c.Wu,{children:[u&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-white/5 rounded-xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm text-white/60",children:"Latest Pipeline"}),(0,r.jsx)("span",{className:"text-xs text-white/40",children:(0,f.A)(new Date(u.createdAt),{addSuffix:!0})})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.icon,{className:`h-4 w-4 ${v.color}`}),(0,r.jsx)("span",{className:`text-sm font-medium ${v.color}`,children:u.status}),u.stage&&(0,r.jsxs)("span",{className:"text-xs text-white/40",children:["• ",u.stage]})]})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(l.$,{size:"sm",onClick:y,loading:o,className:"flex-1 sm:flex-none",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Deploy"]}),(0,r.jsx)(i.default,{href:`/projects/${e.id}`,children:(0,r.jsxs)(l.$,{variant:"secondary",size:"sm",className:"flex-1 sm:flex-none",children:[(0,r.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"View"]})}),(0,r.jsx)("a",{href:e.gitlabUrl,target:"_blank",rel:"noopener noreferrer",className:"flex-1 sm:flex-none",children:(0,r.jsxs)(l.$,{variant:"ghost",size:"sm",className:"w-full",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"GitLab"]})}),t&&(0,r.jsxs)(l.$,{variant:"danger",size:"sm",onClick:()=>t(e.id),className:"flex-1 sm:flex-none",children:[(0,r.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-white/10",children:(0,r.jsxs)("div",{className:"flex justify-between text-xs text-white/60",children:[(0,r.jsxs)("span",{children:["Created ",(0,f.A)(new Date(e.createdAt),{addSuffix:!0})]}),(0,r.jsxs)("span",{children:[e.pipelines.length," pipelines"]})]})})]})]})})}},64833:(e,t,s)=>{s.d(t,{p:()=>n});var r=s(45512),a=s(58009),i=s(82281);let n=(0,a.forwardRef)(({className:e,label:t,error:s,helper:a,...n},c)=>(0,r.jsxs)("div",{className:"space-y-2",children:[t&&(0,r.jsx)("label",{className:"block text-sm font-medium text-github-text",children:t}),(0,r.jsx)("input",{className:(0,i.A)("input-field w-full",{"border-github-danger focus:border-github-danger focus:ring-github-danger/20":s},e),ref:c,...n}),s&&(0,r.jsx)("p",{className:"text-sm text-github-danger",children:s}),a&&!s&&(0,r.jsx)("p",{className:"text-sm text-github-text-tertiary",children:a})]}));n.displayName="Input"},65713:(e,t,s)=>{s.d(t,{Es:()=>m,JQ:()=>d,U1:()=>p,gA:()=>o,xx:()=>u});var r=s(21590);s(70376);var a=s(20145),i=s(96330),n=s(47735),c=s(99344);let l=new i.PrismaClient;async function o(e){try{let t=(0,a.z8)();if((await t.searchProjects(e.name)).find(t=>t.name===e.name))return{success:!1,error:`Project '${e.name}' already exists`};let s=await t.createProject(e.name,e.groupId,e.description),r=await l.project.create({data:{name:e.name,description:e.description,gitlabId:s.id.toString(),gitlabUrl:s.web_url,userId:"system"}}),i=`${process.env.NEXTAUTH_URL}/api/webhooks/gitlab`;return await t.createWebhook(s.id,i,["pipeline_events","job_events"]),(0,n.revalidatePath)("/dashboard"),{success:!0,project:r}}catch(e){return console.error("Error creating project:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}}async function d(){try{return await l.project.findMany({include:{user:!0,pipelines:{orderBy:{createdAt:"desc"},take:5}},orderBy:{createdAt:"desc"}})}catch(e){return console.error("Error fetching projects:",e),[]}}async function p(e){try{return await l.project.findUnique({where:{id:e},include:{user:!0,pipelines:{orderBy:{createdAt:"desc"}}}})}catch(e){return console.error("Error fetching project:",e),null}}async function u(e){try{let t=await l.project.findUnique({where:{id:e}});if(!t)return{success:!1,error:"Project not found"};let s=(0,a.z8)();return await s.deleteProject(t.gitlabId),await l.project.delete({where:{id:e}}),(0,n.revalidatePath)("/dashboard"),{success:!0}}catch(e){return console.error("Error deleting project:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}}async function m(e,t={}){try{let s=await l.project.findUnique({where:{id:e}});if(!s)return{success:!1,error:"Project not found"};let r=(0,a.z8)(),i=await r.triggerPipeline(process.env.PIPELINE_PROJECT_ID,"trigger",{APP_NAME:s.name,GITLAB_TOKEN:process.env.GITLAB_TOKEN,...t});return await l.pipeline.create({data:{gitlabId:i.id.toString(),status:"PENDING",projectId:s.id}}),(0,n.revalidatePath)(`/projects/${e}`),{success:!0,pipeline:i}}catch(e){return console.error("Error triggering pipeline:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}}(0,c.D)([o,d,p,u,m]),(0,r.A)(o,"40fcdc1a3f812a5b9eb8f46640d49a2f893f411151",null),(0,r.A)(d,"009bc55086d7e742f55c8e8d86e8eedc47d17f9089",null),(0,r.A)(p,"40931f7702ad3ada8ecf429b7ceb72a235b6fd9b50",null),(0,r.A)(u,"40e4dcc24163bd9baafc960f2b7aa64806332808df",null),(0,r.A)(m,"60ec98b5edff83b1aeb2e028aacc7a677c1ebe5e8c",null)},20145:(e,t,s)=>{s.d(t,{z8:()=>c});var r=s(64123);class a{constructor(e,t){this.baseURL=e,this.token=t,this.client=r.A.create({baseURL:`${e}/api/v4`,headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},timeout:3e4}),this.client.interceptors.request.use(e=>(console.log(`GitLab API Request: ${e.method?.toUpperCase()} ${e.url}`),e),e=>(console.error("GitLab API Request Error:",e),Promise.reject(e))),this.client.interceptors.response.use(e=>e,e=>(console.error("GitLab API Response Error:",e.response?.data||e.message),Promise.reject(e)))}async getCurrentUser(){return(await this.client.get("/user")).data}async getGroup(e){return(await this.client.get(`/groups/${e}`)).data}async searchGroups(e){return(await this.client.get("/groups",{params:{search:e}})).data}async createProject(e,t,s){return(await this.client.post("/projects",{name:e,namespace_id:t,description:s,visibility:"private",initialize_with_readme:!0})).data}async getProject(e){return(await this.client.get(`/projects/${e}`)).data}async searchProjects(e){return(await this.client.get("/projects",{params:{search:e,membership:!1,order_by:"last_activity_at",sort:"desc"}})).data}async deleteProject(e){await this.client.delete(`/projects/${e}`)}async triggerPipeline(e,t="main",s={}){return(await this.client.post(`/projects/${e}/trigger/pipeline`,{ref:t,variables:Object.entries(s).map(([e,t])=>({key:e,value:t}))})).data}async getPipelines(e,t=1,s=20){return(await this.client.get(`/projects/${e}/pipelines`,{params:{page:t,per_page:s,order_by:"updated_at",sort:"desc"}})).data}async getPipeline(e,t){return(await this.client.get(`/projects/${e}/pipelines/${t}`)).data}async getPipelineJobs(e,t){return(await this.client.get(`/projects/${e}/pipelines/${t}/jobs`)).data}async getJobLogs(e,t){return(await this.client.get(`/projects/${e}/jobs/${t}/trace`)).data}async createWebhook(e,t,s=["pipeline_events"]){return(await this.client.post(`/projects/${e}/hooks`,{url:t,pipeline_events:s.includes("pipeline_events"),job_events:s.includes("job_events"),push_events:s.includes("push_events"),tag_push_events:s.includes("tag_push_events"),issues_events:s.includes("issues_events"),confidential_issues_events:s.includes("confidential_issues_events"),note_events:s.includes("note_events"),confidential_note_events:s.includes("confidential_note_events"),merge_request_events:s.includes("merge_request_events"),wiki_page_events:s.includes("wiki_page_events"),deployment_events:s.includes("deployment_events"),feature_flag_events:s.includes("feature_flag_events"),releases_events:s.includes("releases_events")})).data}async getWebhooks(e){return(await this.client.get(`/projects/${e}/hooks`)).data}async deleteWebhook(e,t){await this.client.delete(`/projects/${e}/hooks/${t}`)}}let i=null,n=null;function c(){let e=process.env.GITLAB_HOST||"https://gitlab.sonod.tech",t=process.env.GITLAB_TOKEN;if(!t)throw Error("GITLAB_TOKEN environment variable is required");return i&&n===e||(n=e,i=new a(e,t)),i}},99207:(e,t,s)=>{s.d(t,{J:()=>a});var r=s(26248);let a=(0,r.createServerReference)("009bc55086d7e742f55c8e8d86e8eedc47d17f9089",r.callServer,void 0,r.findSourceMapURL,"getProjects")},72048:(e,t,s)=>{s.d(t,{x:()=>a});var r=s(26248);let a=(0,r.createServerReference)("40e4dcc24163bd9baafc960f2b7aa64806332808df",r.callServer,void 0,r.findSourceMapURL,"deleteProject")},72269:(e,t,s)=>{s.d(t,{E:()=>a});var r=s(26248);let a=(0,r.createServerReference)("60ec98b5edff83b1aeb2e028aacc7a677c1ebe5e8c",r.callServer,void 0,r.findSourceMapURL,"triggerProjectPipeline")}};