(()=>{var e={};e.id=105,e.ids=[105],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},54611:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>o});var s=r(70260),a=r(28203),i=r(25155),n=r.n(i),l=r(67292),c={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(t,c);let o=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2155)),"/workspace/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,19611)),"/workspace/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"]}],d=["/workspace/app/dashboard/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5495:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"009bc55086d7e742f55c8e8d86e8eedc47d17f9089":()=>s.JQ,"405c9b6b525f6ce03f5882208783da38ec5a910294":()=>a.pF,"40788af307809d0cc632adb83642092ae0c6bcb84b":()=>a.Cz,"40931f7702ad3ada8ecf429b7ceb72a235b6fd9b50":()=>s.U1,"40e4dcc24163bd9baafc960f2b7aa64806332808df":()=>s.xx,"40fcdc1a3f812a5b9eb8f46640d49a2f893f411151":()=>s.gA,"605197d4b27dd2c7747f041ffa42937134b0ef6730":()=>a.fx,"607a77c2d6b93bf48026ba9e8419384307b4c5b85b":()=>a.pI,"60ec98b5edff83b1aeb2e028aacc7a677c1ebe5e8c":()=>s.Es,"70008c638eb6fe0ab52b3184bfd315b84c22b6d521":()=>a.Se});var s=r(65713),a=r(93156)},64316:(e,t,r)=>{Promise.resolve().then(r.bind(r,2155))},22460:(e,t,r)=>{Promise.resolve().then(r.bind(r,64647))},64647:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var s=r(45512),a=r(58009),i=r(8055),n=r(5868),l=r(55595),c=r(24109),o=r(52064),d=r(96121),u=r(12870),p=r(456),x=r(10963),b=r(28994),h=r(90788),g=r(35592),m=r(48208),f=r(99207),y=r(72269),j=r(72048),v=r(86257),w=r(22403);function N(){let{user:e,loading:t}=(0,i.A)(),[r,N]=(0,a.useState)([]),[A,P]=(0,a.useState)([]),[C,S]=(0,a.useState)(!1),[q,_]=(0,a.useState)(!0),E=async()=>{try{let[e,t]=await Promise.all([(0,f.J)(),(0,v.p)(5)]);N(e),P(t)}catch(e){console.error("Error loading dashboard data:",e),w.Ay.error("Failed to load dashboard data")}finally{_(!1)}},I=()=>{S(!0)},D=async e=>{try{let t=await (0,y.E)(e);t.success?(w.Ay.success("Pipeline triggered successfully!"),E()):w.Ay.error(t.error||"Failed to trigger pipeline")}catch(e){w.Ay.error("Failed to trigger pipeline")}},k=async e=>{if(confirm("Are you sure you want to delete this project? This action cannot be undone."))try{let t=await (0,j.x)(e);t.success?(w.Ay.success("Project deleted successfully"),E()):w.Ay.error(t.error||"Failed to delete project")}catch(e){w.Ay.error("Failed to delete project")}};if(t||q)return(0,s.jsx)("div",{className:"min-h-screen bg-github-bg flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-github-accent mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-github-text-secondary",children:"Loading dashboard..."})]})});if(!e)return(0,s.jsx)("div",{className:"min-h-screen bg-github-bg flex items-center justify-center",children:(0,s.jsx)(l.Zp,{variant:"glass",className:"max-w-md mx-auto",children:(0,s.jsxs)(l.Wu,{className:"p-8 text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-github-text mb-4",children:"Authentication Required"}),(0,s.jsx)("p",{className:"text-github-text-secondary mb-6",children:"Please sign in to access the dashboard."}),(0,s.jsx)(c.$,{onClick:()=>window.location.href="/api/auth/signin",children:"Sign In"})]})})});let U=[{label:"Total Projects",value:r.length,icon:x.A,color:"text-blue-400",bg:"bg-blue-500/10"},{label:"Active Pipelines",value:A.filter(e=>"RUNNING"===e.status).length,icon:b.A,color:"text-yellow-400",bg:"bg-yellow-500/10"},{label:"Successful Deployments",value:A.filter(e=>"SUCCESS"===e.status).length,icon:h.A,color:"text-green-400",bg:"bg-green-500/10"},{label:"Failed Deployments",value:A.filter(e=>"FAILED"===e.status).length,icon:g.A,color:"text-red-400",bg:"bg-red-500/10"}];return(0,s.jsxs)("div",{className:"min-h-screen bg-github-bg",children:[(0,s.jsx)(u.Y,{}),(0,s.jsxs)("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-github-text mb-2",children:["Welcome back, ",e?.name?.split(" ")[0],"! \uD83D\uDC4B"]}),(0,s.jsx)("p",{className:"text-github-text-secondary text-lg",children:"Manage your projects and monitor deployments from your dashboard."})]}),(0,s.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:U.map((e,t)=>(0,s.jsx)(l.Zp,{variant:"glass",hover:!0,children:(0,s.jsx)(l.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-github-text-secondary text-sm font-medium",children:e.label}),(0,s.jsx)("p",{className:"text-3xl font-bold text-github-text mt-1",children:e.value})]}),(0,s.jsx)("div",{className:`p-3 rounded-xl ${e.bg}`,children:(0,s.jsx)(e.icon,{className:`h-6 w-6 ${e.color}`})})]})})},e.label))}),(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-github-text",children:"Your Projects"}),(0,s.jsxs)(c.$,{onClick:I,children:[(0,s.jsx)(m.A,{className:"h-5 w-5 mr-2"}),"Create Project"]})]}),0===r.length?(0,s.jsx)(l.Zp,{variant:"glass",className:"text-center py-12",children:(0,s.jsxs)(l.Wu,{children:[(0,s.jsx)(x.A,{className:"h-16 w-16 text-github-text-tertiary mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-github-text mb-2",children:"No projects yet"}),(0,s.jsx)("p",{className:"text-github-text-secondary mb-6",children:"Create your first Next.js project to get started with automated deployments."}),(0,s.jsxs)(c.$,{onClick:I,children:[(0,s.jsx)(m.A,{className:"h-5 w-5 mr-2"}),"Create Your First Project"]})]})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((e,t)=>(0,s.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},children:(0,s.jsx)(o.U,{project:e,onTriggerPipeline:D,onDelete:k})},e.id))})]}),A.length>0&&(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-github-text mb-6",children:"Recent Activity"}),(0,s.jsxs)(l.Zp,{variant:"glass",children:[(0,s.jsx)(l.aR,{children:(0,s.jsx)(l.ZB,{className:"text-github-text",children:"Pipeline Activity"})}),(0,s.jsx)(l.Wu,{children:(0,s.jsx)("div",{className:"space-y-4",children:A.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-github-bg-tertiary rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:`p-2 rounded-lg ${"SUCCESS"===e.status?"bg-green-500/10":"FAILED"===e.status?"bg-red-500/10":"RUNNING"===e.status?"bg-blue-500/10":"bg-yellow-500/10"}`,children:"SUCCESS"===e.status?(0,s.jsx)(h.A,{className:"h-5 w-5 text-green-400"}):"FAILED"===e.status?(0,s.jsx)(g.A,{className:"h-5 w-5 text-red-400"}):(0,s.jsx)(b.A,{className:"h-5 w-5 text-blue-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-github-text font-medium",children:e.project?.name}),(0,s.jsxs)("p",{className:"text-github-text-secondary text-sm",children:[e.stage&&`${e.stage} â€¢ `,new Date(e.createdAt).toLocaleString()]})]})]}),(0,s.jsx)("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${"SUCCESS"===e.status?"bg-green-500/10 text-green-400":"FAILED"===e.status?"bg-red-500/10 text-red-400":"RUNNING"===e.status?"bg-blue-500/10 text-blue-400":"bg-yellow-500/10 text-yellow-400"}`,children:e.status})]},e.id))})})]})]})]}),(0,s.jsx)(p.w,{}),(0,s.jsx)(d.D,{isOpen:C,onClose:()=>S(!1),onSuccess:()=>{E()}})]})}},2155:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspace/app/dashboard/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/app/dashboard/page.tsx","default")},93156:(e,t,r)=>{"use strict";r.d(t,{Cz:()=>o,Se:()=>p,fx:()=>u,pF:()=>x,pI:()=>d});var s=r(21590);r(70376);var a=r(20145),i=r(96330),n=r(47735),l=r(99344);let c=new i.PrismaClient;async function o(e){try{let t=await c.project.findUnique({where:{id:e}});if(!t)return[];let r=(0,a.z8)();for(let e of(await r.getPipelines(t.gitlabId)))await c.pipeline.upsert({where:{gitlabId:e.id.toString()},update:{status:e.status.toUpperCase(),stage:e.stages?.[0],startedAt:e.started_at?new Date(e.started_at):null,finishedAt:e.finished_at?new Date(e.finished_at):null,duration:e.duration},create:{gitlabId:e.id.toString(),status:e.status.toUpperCase(),stage:e.stages?.[0],startedAt:e.started_at?new Date(e.started_at):null,finishedAt:e.finished_at?new Date(e.finished_at):null,duration:e.duration,projectId:t.id}});return await c.pipeline.findMany({where:{projectId:e},orderBy:{createdAt:"desc"}})}catch(e){return console.error("Error fetching pipelines:",e),[]}}async function d(e,t){try{let r=await c.project.findUnique({where:{id:e}});if(!r)return null;let s=(0,a.z8)(),i=await s.getPipeline(r.gitlabId,t),n=await s.getPipelineJobs(r.gitlabId,t);return{pipeline:i,jobs:n}}catch(e){return console.error("Error fetching pipeline details:",e),null}}async function u(e,t){try{let r=await c.project.findUnique({where:{id:e}});if(!r)return null;let s=(0,a.z8)();return await s.getJobLogs(r.gitlabId,t)}catch(e){return console.error("Error fetching job logs:",e),null}}async function p(e,t,r){try{await c.pipeline.update({where:{gitlabId:e},data:{status:t.toUpperCase(),stage:r,updatedAt:new Date}}),(0,n.revalidatePath)("/dashboard"),(0,n.revalidatePath)("/projects")}catch(e){console.error("Error updating pipeline status:",e)}}async function x(e=10){try{return await c.pipeline.findMany({include:{project:!0},orderBy:{createdAt:"desc"},take:e})}catch(e){return console.error("Error fetching recent pipelines:",e),[]}}(0,l.D)([o,d,u,p,x]),(0,s.A)(o,"40788af307809d0cc632adb83642092ae0c6bcb84b",null),(0,s.A)(d,"607a77c2d6b93bf48026ba9e8419384307b4c5b85b",null),(0,s.A)(u,"605197d4b27dd2c7747f041ffa42937134b0ef6730",null),(0,s.A)(p,"70008c638eb6fe0ab52b3184bfd315b84c22b6d521",null),(0,s.A)(x,"405c9b6b525f6ce03f5882208783da38ec5a910294",null)},86257:(e,t,r)=>{"use strict";r.d(t,{p:()=>a});var s=r(26248);let a=(0,s.createServerReference)("405c9b6b525f6ce03f5882208783da38ec5a910294",s.callServer,void 0,s.findSourceMapURL,"getRecentPipelines")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[989,83,800,585,51,654,527,633],()=>r(54611));module.exports=s})();