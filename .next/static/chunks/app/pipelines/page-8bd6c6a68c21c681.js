(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{3033:(e,s,t)=>{Promise.resolve().then(t.bind(t,3845))},3845:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>U});var i=t(5155),a=t(2115),l=t(4651),n=t(3562),c=t(8207),r=t(1909),d=t(4826),o=t(2526),x=t(3594),h=t(7072),m=t(915),j=t(351),p=t(8610),u=t(3278),b=t(2020);let g={SUCCESS:{color:"text-green-400",icon:d.A,bg:"bg-green-500/10",border:"border-green-500/20"},FAILED:{color:"text-red-400",icon:o.A,bg:"bg-red-500/10",border:"border-red-500/20"},RUNNING:{color:"text-blue-400",icon:x.A,bg:"bg-blue-500/10",border:"border-blue-500/20"},PENDING:{color:"text-yellow-400",icon:h.A,bg:"bg-yellow-500/10",border:"border-yellow-500/20"},CANCELED:{color:"text-gray-400",icon:m.A,bg:"bg-gray-500/10",border:"border-gray-500/20"},SKIPPED:{color:"text-gray-400",icon:h.A,bg:"bg-gray-500/10",border:"border-gray-500/20"}};function N(e){let{pipeline:s,onViewDetails:t,onViewLogs:l}=e,[d,o]=(0,a.useState)(!1),x=g[s.status]||g.PENDING,h=()=>"SUCCESS"===s.status||"FAILED"===s.status?100:"RUNNING"===s.status&&s.duration?Math.min((Date.now()-new Date(s.startedAt||s.createdAt).getTime())/(1e3*s.duration)*100,90):0;return(0,i.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,i.jsxs)(c.Zp,{variant:"glass",hover:!0,className:"border ".concat(x.border," ").concat(d?"ring-2 ring-primary-500/20":""),children:[(0,i.jsx)(c.aR,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"p-2 rounded-lg ".concat(x.bg),children:(0,i.jsx)(x.icon,{className:"h-5 w-5 ".concat(x.color)})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.ZB,{className:"text-white text-lg",children:s.project.name}),(0,i.jsxs)("p",{className:"text-white/60 text-sm",children:["Pipeline #",s.gitlabId,s.stage&&" • ".concat(s.stage)]})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("div",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(x.bg," ").concat(x.color),children:s.status}),(0,i.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>o(!d),children:(0,i.jsx)(j.A,{className:"h-4 w-4"})})]})]})}),(0,i.jsxs)(c.Wu,{children:["RUNNING"===s.status&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm text-white/60 mb-2",children:[(0,i.jsx)("span",{children:"Progress"}),(0,i.jsxs)("span",{children:[Math.round(h()),"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-white/10 rounded-full h-2",children:(0,i.jsx)(n.P.div,{className:"bg-gradient-to-r from-primary-500 to-secondary-500 h-2 rounded-full",initial:{width:0},animate:{width:"".concat(h(),"%")},transition:{duration:.5}})})]}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-white/60",children:"Created"}),(0,i.jsx)("span",{className:"text-white",children:(0,u.A)(new Date(s.createdAt),{addSuffix:!0})})]}),s.startedAt&&(0,i.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-white/60",children:"Started"}),(0,i.jsx)("span",{className:"text-white",children:(0,b.A)(new Date(s.startedAt),"MMM dd, HH:mm")})]}),s.finishedAt&&(0,i.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-white/60",children:"Finished"}),(0,i.jsx)("span",{className:"text-white",children:(0,b.A)(new Date(s.finishedAt),"MMM dd, HH:mm")})]}),s.duration&&(0,i.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-white/60",children:"Duration"}),(0,i.jsx)("span",{className:"text-white",children:(e=>{if(!e)return"N/A";let s=Math.floor(e/60);return"".concat(s,"m ").concat(e%60,"s")})(s.duration)})]})]}),d&&(0,i.jsx)(n.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-4 pt-4 border-t border-white/10",children:(0,i.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,i.jsxs)(r.$,{size:"sm",onClick:()=>null==t?void 0:t(s.id),children:[(0,i.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"View Details"]}),(0,i.jsxs)(r.$,{variant:"secondary",size:"sm",onClick:()=>null==l?void 0:l(s.id),children:[(0,i.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"View Logs"]}),(0,i.jsx)("a",{href:"".concat(s.project.gitlabUrl,"/-/pipelines/").concat(s.gitlabId),target:"_blank",rel:"noopener noreferrer",children:(0,i.jsxs)(r.$,{variant:"ghost",size:"sm",children:[(0,i.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"GitLab"]})})]})})]})]})})}var f=t(4247),y=t(236),v=t(8552),w=t(9335),A=t(6743),S=t(5828);let k=(0,S.createServerReference)("605197d4b27dd2c7747f041ffa42937134b0ef6730",S.callServer,void 0,S.findSourceMapURL,"getJobLogs");var C=t(5037);function E(e){let{isOpen:s,onClose:t,projectId:l,jobId:d,jobName:o}=e,[h,m]=(0,a.useState)(""),[j,p]=(0,a.useState)(!1),[u,b]=(0,a.useState)(!0),[g,N]=(0,a.useState)(!1);(0,a.useEffect)(()=>{s&&d&&S()},[s,d]);let S=async()=>{p(!0);try{let e=await k(l,d);m(e||"No logs available")}catch(e){console.error("Error loading logs:",e),C.Ay.error("Failed to load logs"),m("Failed to load logs")}finally{p(!1)}},E=()=>{let e=document.getElementById("log-container");e&&(e.scrollTop=e.scrollHeight)};return(0,a.useEffect)(()=>{u&&E()},[h,u]),(0,i.jsx)(f.N,{children:s&&(0,i.jsxs)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,i.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),(0,i.jsx)(n.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative w-full max-w-6xl h-[80vh]",children:(0,i.jsxs)(c.Zp,{variant:"glass",className:"border-white/20 h-full flex flex-col",children:[(0,i.jsx)(c.aR,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/10",children:(0,i.jsx)(x.A,{className:"h-5 w-5 text-blue-400"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.ZB,{className:"text-white",children:"Pipeline Logs"}),(0,i.jsx)("p",{className:"text-white/60 text-sm",children:o})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsxs)(r.$,{variant:"ghost",size:"sm",onClick:()=>{if(N(!g),!g){let e=setInterval(()=>{g?S():clearInterval(e)},5e3)}},className:g?"bg-green-500/10 text-green-400":"",children:[g?(0,i.jsx)(y.A,{className:"h-4 w-4"}):(0,i.jsx)(x.A,{className:"h-4 w-4"}),g?"Live":"Static"]}),(0,i.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>{S()},loading:j,children:(0,i.jsx)(v.A,{className:"h-4 w-4"})}),(0,i.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>{let e=new Blob([h],{type:"text/plain"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="".concat(o,"-logs.txt"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},children:(0,i.jsx)(w.A,{className:"h-4 w-4"})}),(0,i.jsx)(r.$,{variant:"ghost",size:"sm",onClick:t,children:(0,i.jsx)(A.A,{className:"h-5 w-5"})})]})]})}),(0,i.jsxs)(c.Wu,{className:"flex-1 flex flex-col",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4 p-3 bg-white/5 rounded-xl",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("label",{className:"flex items-center space-x-2 text-sm",children:[(0,i.jsx)("input",{type:"checkbox",checked:u,onChange:e=>b(e.target.checked),className:"rounded border-white/20 bg-white/5"}),(0,i.jsx)("span",{className:"text-white/80",children:"Auto-scroll"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-white/60",children:[(0,i.jsxs)("span",{children:["Lines: ",h.split("\n").length]}),(0,i.jsx)("span",{children:"•"}),(0,i.jsxs)("span",{children:["Size: ",new Blob([h]).size," bytes"]})]})]}),(0,i.jsx)(r.$,{variant:"ghost",size:"sm",onClick:E,className:"text-white/60 hover:text-white",children:"Scroll to Bottom"})]}),(0,i.jsx)("div",{className:"flex-1 bg-dark-800 rounded-xl border border-white/10 overflow-hidden",children:(0,i.jsx)("div",{id:"log-container",className:"h-full overflow-auto p-4 font-mono text-sm",style:{maxHeight:"calc(80vh - 200px)"},children:j?(0,i.jsxs)("div",{className:"flex items-center justify-center h-32",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),(0,i.jsx)("span",{className:"ml-3 text-white/60",children:"Loading logs..."})]}):(0,i.jsx)("pre",{className:"text-white/90 whitespace-pre-wrap break-words",children:h||"No logs available"})})}),(0,i.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-white/60",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("span",{children:["Job ID: ",d]}),(0,i.jsx)("span",{children:"•"}),(0,i.jsxs)("span",{children:["Project: ",l]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:g&&(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,i.jsx)("span",{children:"Live"})]})})]})]})]})})]})})}var I=t(734),P=t(7564),L=t(1572),D=t(1340);let R=[{key:"all",label:"All",icon:L.A},{key:"RUNNING",label:"Running",icon:x.A},{key:"SUCCESS",label:"Success",icon:d.A},{key:"FAILED",label:"Failed",icon:o.A},{key:"PENDING",label:"Pending",icon:h.A}];function U(){let{user:e,loading:s}=(0,l.A)(),[t,d]=(0,a.useState)([]),[o,h]=(0,a.useState)([]),[m,j]=(0,a.useState)(!0),[p,u]=(0,a.useState)("all"),[b,g]=(0,a.useState)(null),[f,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e&&!s&&w()},[e,s]),(0,a.useEffect)(()=>{A()},[t,p]);let w=async()=>{try{let e=await (0,D.p)(50);d(e)}catch(e){console.error("Error loading pipelines:",e),C.Ay.error("Failed to load pipelines")}finally{j(!1)}},A=()=>{"all"===p?h(t):h(t.filter(e=>e.status===p))},S=e=>{let s=t.find(s=>s.id===e);s&&(g(s),console.log("View details for pipeline:",e))},k=e=>{let s=t.find(s=>s.id===e);s&&(g(s),y(!0))};if(s||m)return(0,i.jsx)("div",{className:"min-h-screen bg-github-bg flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-github-accent mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-github-text-secondary",children:"Loading pipelines..."})]})});if(!e)return(0,i.jsx)("div",{className:"min-h-screen bg-github-bg flex items-center justify-center",children:(0,i.jsx)(c.Zp,{variant:"glass",className:"max-w-md mx-auto",children:(0,i.jsxs)(c.Wu,{className:"p-8 text-center",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-github-text mb-4",children:"Authentication Required"}),(0,i.jsx)("p",{className:"text-github-text-secondary mb-6",children:"Please sign in to view pipelines."}),(0,i.jsx)(r.$,{onClick:()=>window.location.href="/api/auth/signin",children:"Sign In"})]})})});let L={all:t.length,RUNNING:t.filter(e=>"RUNNING"===e.status).length,SUCCESS:t.filter(e=>"SUCCESS"===e.status).length,FAILED:t.filter(e=>"FAILED"===e.status).length,PENDING:t.filter(e=>"PENDING"===e.status).length};return(0,i.jsxs)("div",{className:"min-h-screen bg-github-bg",children:[(0,i.jsx)(I.Y,{}),(0,i.jsxs)("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,i.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-4xl font-bold text-github-text mb-2",children:"Pipeline Monitor"}),(0,i.jsx)("p",{className:"text-github-text-secondary text-lg",children:"Monitor and manage your deployment pipelines in real-time."})]}),(0,i.jsxs)(r.$,{onClick:()=>{j(!0),w()},loading:m,children:[(0,i.jsx)(v.A,{className:"h-5 w-5 mr-2"}),"Refresh"]})]})}),(0,i.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"mb-8",children:(0,i.jsx)(c.Zp,{variant:"glass",children:(0,i.jsx)(c.Wu,{className:"p-6",children:(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:R.map(e=>{let s=L[e.key],t=p===e.key;return(0,i.jsxs)(r.$,{variant:t?"primary":"ghost",size:"sm",onClick:()=>u(e.key),className:"flex items-center space-x-2",children:[(0,i.jsx)(e.icon,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.label}),(0,i.jsx)("span",{className:"px-2 py-1 rounded-full bg-white/10 text-xs",children:s})]},e.key)})})})})}),(0,i.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:0===o.length?(0,i.jsx)(c.Zp,{variant:"glass",className:"text-center py-12",children:(0,i.jsxs)(c.Wu,{children:[(0,i.jsx)(x.A,{className:"h-16 w-16 text-github-text-tertiary mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-xl font-semibold text-github-text mb-2",children:"No pipelines found"}),(0,i.jsx)("p",{className:"text-github-text-secondary mb-6",children:"all"===p?"No pipelines have been created yet.":'No pipelines with status "'.concat(p,'" found.')}),(0,i.jsx)(r.$,{onClick:()=>u("all"),children:"View All Pipelines"})]})}):(0,i.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:o.map((e,s)=>(0,i.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*s},children:(0,i.jsx)(N,{pipeline:e,onViewDetails:S,onViewLogs:k})},e.id))})}),b&&(0,i.jsx)(E,{isOpen:f,onClose:()=>{y(!1),g(null)},projectId:b.projectId,jobId:b.gitlabId,jobName:"Pipeline ".concat(b.gitlabId)})]}),(0,i.jsx)(P.w,{})]})}},1340:(e,s,t)=>{"use strict";t.d(s,{p:()=>a});var i=t(5828);let a=(0,i.createServerReference)("405c9b6b525f6ce03f5882208783da38ec5a910294",i.callServer,void 0,i.findSourceMapURL,"getRecentPipelines")}},e=>{var s=s=>e(e.s=s);e.O(0,[178,715,37,64,223,233,441,517,358],()=>s(3033)),_N_E=e.O()}]);